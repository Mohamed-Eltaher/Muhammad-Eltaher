!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(t,e,n){},function(t,e){Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=[],a=arguments.length>=2?arguments[1]:void 0,o=0;o<n;o++)if(o in e){var s=e[o];t.call(a,s,o,e)&&i.push(s)}return i})},function(t,e){Array.prototype.find||(Array.prototype.find=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,a=arguments[1],o=0;o<i;o++)if(e=n[o],t.call(a,e,o,n))return e})},function(t,e){var n;n={}},function(t,e,n){(function(t){t.CROP_THUMBNAILS_VUE={app:null,components:{}}}).call(this,n(5))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){CROP_THUMBNAILS_DO_CACHE_BREAK=function(t){for(var e=jQuery,n=e(t),i=0;i<n.length;i++){var a=e(n[i]),o=a.attr("src").split("?");a.attr("src",o[0]+"?&cacheBreak="+(new Date).getTime())}}},function(t,e){jQuery(document).ready(function(t){t(document).on("click",".cropThumbnailsLink",function(e){e.preventDefault();var n=t(this).data("cropthumbnail"),i=t(this).attr("title"),a=null;void 0!==n.posttype&&(a=n.posttype),(new CROP_THUMBNAILS_VUE.modal).open(n.image_id,a,i)})})},function(t,e){CROP_THUMBNAILS_VUE.modal=function(){var t=jQuery,e=this;e.close=function(n){CROP_THUMBNAILS_VUE.app.$destroy(),CROP_THUMBNAILS_VUE.app=null,t("#cpt_Modal .cpt_ModalClose, #cpt_Modal").unbind("click"),t("#cpt_Modal").remove(),t("body").removeClass("cpt_ModalIsOpen"),t("body").trigger("cropThumbnailModalClosed"),document.removeEventListener("keydown",e.closeByEscKey,!0)},e.closeByBackground=function(t){t.target==document.getElementById("cpt_Modal")&&e.close(t)},e.closeByEscKey=function(t){t.keyCode&&27!==t.keyCode||(t.stopPropagation(),e.close(t))},e.open=function(n,i,a){var o=n,s="";s+='<div id="cpt_Modal" class="cpt_Modal">',s+='<div class="cpt_ModalDialog" role="dialog" aria-label="'+t("<div>").text(a).html()+'">',s+='<button type="button" class="cpt_ModalClose" aria-label="close">&times;</button>',s+='<div class="cpt_ModalHeader"><div class="cpt_ModalTitle">'+a+"</div></div>",s+='<div class="cpt_ModalContent" id="cpt_crop_editor">',s+='<cropeditor :image-id="'+o+'"',"string"==typeof i&&(s+=' posttype="'+i+'"'),s+="></cropeditor>",s+="</div>",s+="</div>",s+="</div>",t("body").prepend(s).addClass("cpt_ModalIsOpen"),t("#cpt_Modal .cpt_ModalClose").click(e.close),t("#cpt_Modal").on("touchstart mousedown",e.closeByBackground),document.addEventListener("keydown",e.closeByEscKey,!0),CROP_THUMBNAILS_VUE.app=new Vue({el:"#cpt_crop_editor",mounted:function(){console.log("cpt_crop_editor mounted")},components:CROP_THUMBNAILS_VUE.components})}}},function(t,e){CROP_THUMBNAILS_VUE.components.message={template:"@./message.tpl.html",props:{},data:function(){return{closed:!1}},methods:{close:function(){this.closed=!0}}}},function(t,e,n){CROP_THUMBNAILS_VUE.components.loadingcontainer={template:n(11),props:{image:{required:!0,type:String}},data:function(){return{status:null}},watch:{image:function(){this.setup()}},mounted:function(){this.setup()},methods:{setup:function(){var t=this;t.setStart(),setTimeout(function(){imagesLoaded(t.$el).once("done",function(){"failed"!==t.status&&t.setComplete()}).once("fail",function(){t.setFailed()})},300)},setComplete:function(){this.status="completed"},setStart:function(){this.status="loading"},setFailed:function(){this.status="failed"}}}},function(t,e){t.exports='<div class="loadingcontainer" :class="status">\n\t<img :src="image" style="display:none;" />\n\t<slot></slot>\n\t\n\t<transition name="fade">\n\t\t<div class="loadingMsg" v-if="status===\'loading\'">\n\t\t\t<div class="cptLoadingSpinner"></div>\n\t\t</div>\n\t</transition>\n</div>\n'},function(t,e,n){CROP_THUMBNAILS_VUE.components.cropeditor={template:n(13),props:{imageId:{required:!0,type:Number},posttype:{required:!1,type:String,default:null}},components:{loadingcontainer:CROP_THUMBNAILS_VUE.components.loadingcontainer,message:CROP_THUMBNAILS_VUE.components.message},data:function(){return{cropData:null,loading:!1,selectSameRatio:!0,croppingApi:null,currentCropSize:null,lang:null,nonce:null,showDebugType:null,dataDebug:null}},mounted:function(){this.loadCropData()},computed:{cropImage:function(){if(void 0!==this.cropData){var t=this.cropData.sourceImage.full,e=Math.round(10*t.ratio);return null!==this.cropData.sourceImage.large&&this.cropData.sourceImage.large.width>745&&e===Math.round(10*this.cropData.sourceImage.large.ratio)&&this.cropData.sourceImage.full.url!==this.cropData.sourceImage.large.url&&(t=this.cropData.sourceImage.large),null!==this.cropData.sourceImage.medium_large&&this.cropData.sourceImage.medium_large.width>745&&e===Math.round(10*this.cropData.sourceImage.medium_large.ratio)&&this.cropData.sourceImage.full.url!==this.cropData.sourceImage.medium_large.url&&(t=this.cropData.sourceImage.medium_large),t}},filteredImageSizes:function(){return this.cropData.imageSizes.filter(function(t){return!t.hideByPostType})},activeImageSizes:function(){return this.cropData.imageSizes.filter(function(t){return t.active})},sourceImageHasOrientation:function(){try{if("string"==typeof this.cropData.sourceImageMeta.orientation&&"1"!==this.cropData.sourceImageMeta.orientation&&"0"!==this.cropData.sourceImageMeta.orientation)return!0}catch(t){}return!1}},methods:{imageSizeClass:function(t){var e={active:t.active};return e["cptImageSize-"+t.nameLabel]=!0,e},loadCropData:function(){var t=this,e={action:"cpt_cropdata",imageId:this.imageId,posttype:this.posttype};t.loading=!0,jQuery.get(ajaxurl,e,function(e){t.makeAllInactive(e.imageSizes),t.addCacheBreak(e.imageSizes),t.cropData=e,t.lang=t.cropData.lang,t.nonce=t.cropData.nonce,delete t.cropData.nonce}).fail(function(e){t.cropData=e.responseJSON,t.lang=t.cropData.lang,t.nonce=t.cropData.nonce,delete t.cropData.nonce,403===e.status&&(t.cropData.noPermission=!0)}).always(function(){t.loading=!1})},isLowRes:function(t){return!(!t.active||null===this.currentCropSize)&&(0===t.width&&this.currentCropSize.height<t.height||(0===t.height&&this.currentCropSize.width<t.width||(9999===t.height?this.currentCropSize.width<t.width:9999===t.width?this.currentCropSize.height<t.height:this.currentCropSize.width<t.width||this.currentCropSize.height<t.height)))},toggleActive:function(t){var e=!t.active;!1===t.active&&this.makeAllInactive(),this.selectSameRatio?this.cropData.imageSizes.forEach(function(n){n.printRatio===t.printRatio&&!1===n.hideByPostType&&(n.active=e)}):t.active=e,this.activeImageSizes.length>0?this.activateCropArea():this.deactivateCropArea()},makeAllInactive:function(t){void 0===t&&(t=this.cropData.imageSizes),t.forEach(function(t){t.active=!1,t.lowResWarning=!1}),this.deactivateCropArea()},addCacheBreak:function(t){void 0===t&&(t=this.cropData.imageSizes),t.forEach(function(t){t.cacheBreak=Date.now()})},updateCurrentCrop:function(){var t=null;if(null!==this.croppingApi){var e=this.croppingApi.tellSelect();t={width:Math.round(e.w),height:Math.round(e.h)}}this.currentCropSize=t},activateCropArea:function(){var t=this;t.deactivateCropArea();var e,n,i,a,o,s,r,c={trueSize:[t.cropData.sourceImage.full.width,t.cropData.sourceImage.full.height],aspectRatio:0,setSelect:[],onSelect:t.updateCurrentCrop};t.activeImageSizes.forEach(function(t){0===c.aspectRatio&&(c.aspectRatio=t.ratio),c.aspectRatio!==t.ratio&&console.info('Crop Thumbnails: print ratio is different from normal ratio on image size "'+t.name+'".')}),c.setSelect=(e=t.cropData.sourceImage.full.width,n=t.cropData.sourceImage.full.height,i=c.aspectRatio,a=0,o=0,s=e,r=n,e/n<=i?r=n-(o=n/2-e/i/2):s=e-(a=e/2-n*i/2),[a,o,s,r]),t.cropData.options.debug_js&&console.info("Cropping options",c),jQuery(t.$el).find("img.cptCroppingImage").Jcrop(c,function(){t.croppingApi=this,t.updateCurrentCrop()})},deactivateCropArea:function(){null!==this.croppingApi&&(this.croppingApi.destroy(),this.croppingApi=null,this.currentCropSize=null)},showDebugClick:function(t){this.showDebugType===t?this.showDebugType=null:this.showDebugType=t},cropThumbnails:function(){var t,e=this;if(!e.loading&&null!==e.croppingApi){e.loading=!0;var n={action:"cptSaveThumbnail",_ajax_nonce:e.nonce,cookie:encodeURIComponent(document.cookie),crop_thumbnails:JSON.stringify({selection:e.croppingApi.tellSelect(),sourceImageId:e.cropData.sourceImageId,activeImageSizes:(t=[],e.activeImageSizes.forEach(function(e){if(e.active){var n={name:e.name,width:e.width,height:e.height,ratio:e.ratio,crop:e.crop};t.push(n)}}),t)})};jQuery.post(ajaxurl,n,null,"json").done(function(t){if(e.cropData.options.debug_data&&(e.dataDebug=t.debug,console.log("Save Function Debug",t.debug)),void 0===t.error)return void 0!==t.success?(void 0!==t.changedImageName&&e.activeImageSizes.forEach(function(e,n){void 0!==t.changedImageName[e.name]&&(e.url=t.changedImageName[e.name])}),void e.addCacheBreak(e.activeImageSizes)):void 0;alert(t.error)}).fail(function(t){alert(e.lang.script_connection_error);var i={status:t.status,statusText:t.statusText,requestUrl:ajaxurl,requestParams:n};console.error("crop-thumbnails connection error",i)}).always(function(){e.loading=!1})}}}}},function(t,e){t.exports='<div class="cptEditorInner" v-if="cropData && lang" :class="{loading:loading,cropEditorActive:croppingApi}">\n\t\n\t<div class="cptWaitingWindow" v-if="loading">\n\t\t<div class="msg">\n\t\t\t{{ lang.waiting }}\n\t\t\t<div>\n\t\t\t\t<div class="cptLoadingSpinner"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\n\t<div class="cptWaitingWindow cptCropDisabledMsg" v-if="cropData.hiddenOnPostType">\n\t\t<div class="msg">{{lang.cropDisabled}}</div>\n\t</div>\n\t\n\t<div class="cptWaitingWindow cptNoPermissionMsg" v-if="cropData.noPermission">\n\t\t<div class="msg">{{lang.noPermission}}</div>\n\t</div>\n\n\t<div class="mainWindow" v-if="!cropData.hiddenOnPostType && !cropData.noPermission">\n\t\t\n\t\t<div class="cptSelectionPane" :class="{ cptImagesAreSelected : (activeImageSizes.length>0) }">\n\t\t\t<div class="cptSelectionPaneInner">\n\t\t\t\t<message v-if="sourceImageHasOrientation">{{lang.message_image_orientation}}</message>\n\t\t\t\t<p>\n\t\t\t\t\t<label class="cptSameRatioLabel">\n\t\t\t\t\t\t<input type="checkbox" v-model="selectSameRatio" />\n\t\t\t\t\t\t{{lang.label_same_ratio}}\n\t\t\t\t\t</label>\n\t\t\t\t\t<button type="button" class="button" @click="makeAllInactive()">{{lang.label_deselect_all}}</button>\n\t\t\t\t</p>\n\t\t\t\t<ul class="cptImageSizelist">\n\t\t\t\t\t<li v-for="i in filteredImageSizes" :class="imageSizeClass(i)" @click="toggleActive(i)">\n\t\t\t\t\t\t<section class="cptImageSizeInner">\n\t\t\t\t\t\t\t<header>{{i.nameLabel}}</header>\n\t\t\t\t\t\t\t<div class="lowResWarning" v-if="isLowRes(i)" :title="lang.lowResWarning"><span>!</span></div>\n\t\t\t\t\t\t\t<div class="notYetCropped" v-if="!isLowRes(i) && i.url === cropData.sourceImage.full.url" :title="lang.notYetCropped"><span class="dashicons dashicons-image-crop"></span></div>\n\t\t\t\t\t\t\t<div class="dimensions">{{ lang.dimensions }} {{i.width}} x {{i.height}} {{ lang.pixel }}</div>\n\t\t\t\t\t\t\t<div class="ratio">{{ lang.ratio }} {{i.printRatio}}</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<loadingcontainer :image="i.url+\'?cacheBreak=\'+i.cacheBreak">\n\t\t\t\t\t\t\t\t<div class="cptImageBgContainer" :style="{\'background-image\': \'url(\'+i.url+\'?cacheBreak=\'+i.cacheBreak+\')\'}"></div>\n\t\t\t\t\t\t\t</loadingcontainer>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="cptCropPane">\n\t\t\t<div class="info">\n\t\t\t\t<h3>{{ lang.rawImage }}</h3>\n\t\t\t\t<div class="dimensions">{{ lang.dimensions }} {{cropData.sourceImage.full.width}} x {{cropData.sourceImage.full.height}} {{ lang.pixel }}</div>\n\t\t\t\t<div class="ratio">{{ lang.ratio }} {{cropData.sourceImage.full.printRatio}}</div>\n\t\t\t</div>\n\t\t\t<button type="button" class="button cptGenerate" :class="{\'button-primary\':croppingApi}" @click="cropThumbnails()" :disabled="!croppingApi">{{ lang.label_crop }}</button>\n\t\t\t\n\t\t\t<div class="cropContainer">\n\t\t\t\t<img class="cptCroppingImage" :src="cropImage.url" />\n\t\t\t</div>\n\t\n\t\t\t<h4>{{ lang.instructions_header }}</h4>\n\t\t\t<ul class="step-info">\n\t\t\t\t<li>{{ lang.instructions_step_1 }}</li>\n\t\t\t\t<li>{{ lang.instructions_step_2 }}</li>\n\t\t\t\t<li>{{ lang.instructions_step_3 }}</li>\n\t\t\t</ul>\n\n\t\t\t<div>\n\t\t\t\t<button type="button" class="button" v-if="cropData.options.debug_js" @click="showDebugClick(\'js\')">show JS-Debug</button>\n\t\t\t\t<button type="button" class="button" v-if="cropData.options.debug_data && dataDebug!==null" @click="showDebugClick(\'data\')">show Data-Debug</button>\n\t\t\t\t<pre v-if="showDebugType===\'data\'">{{ dataDebug }}</pre>\n\t\t\t\t<pre v-if="showDebugType===\'js\'"><br />cropImage:{{cropImage}}<br />cropData:{{ cropData }}</pre>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},function(t,e){jQuery(document).ready(function(t){t("body.settings_page_page-cpt").length>0&&(CROP_THUMBNAILS_VUE.app=new Vue({el:"#cpt_settings_settingsscreen",mounted:function(){},components:CROP_THUMBNAILS_VUE.components}))})},function(t,e){t.exports='<div>\n\n    <div class="cptSettingsPostListDescription">{{settingsData.lang.choose_image_sizes}}</div>\n    <ul class="cptSettingsPostList">\n\n        <li v-for="postType in settingsData.post_types">\n            <section>\n                <header><h3>{{postType.label}}</h3></header>\n\n                \n                <ul class="cptImageSizes">\n                    <li v-for="imageSize in settingsData.image_sizes" v-if="imageSize.crop">\n                        <label>\n                            <input type="checkbox" :value="imageSize.id" :name="\'crop-post-thumbs[hide_size][\'+postType.name+\'][\'+imageSize.id+\']\'" :checked="isImageSizeHidden(postType.name,imageSize.id)"/>\n                            <span class="name">{{imageSize.name}}</span>\n                            <span class="defaultName" v-if="imageSize.name!==imageSize.id">({{imageSize.id}})</span>\n                        </label>\n                    </li>\n                </ul>\n                \n                <label>\n                    <input id="cpt_settings_post" type="checkbox" :name="\'crop-post-thumbs[hide_post_type][\'+postType.name+\']\'" value="1" :checked="isButtonHiddenOnPostType(postType.name)">\n                     {{settingsData.lang.hide_on_post_type}}\n                </label>\n            </section>\n        </li>\n    </ul>\n    \n</div>'},function(t,e,n){"use strict";n.r(e);n(0),n(1),n(2),n(3),n(4),n(6),n(7),n(8),n(9),n(10),n(12),n(14);CROP_THUMBNAILS_VUE.components["cpt-settingsscreen"]={template:n(15),props:{settings:{required:!0}},components:{},data:function(){return{settingsData:JSON.parse(this.settings)}},mounted:function(){},computed:{},methods:{isButtonHiddenOnPostType:function(t){return this.settingsData.options&&this.settingsData.options.hide_post_type&&"1"===this.settingsData.options.hide_post_type[t]},isImageSizeHidden:function(t,e){return this.settingsData.options&&this.settingsData.options.hide_size&&this.settingsData.options.hide_size[t]&&"1"===this.settingsData.options.hide_size[t][e]}}}}]);